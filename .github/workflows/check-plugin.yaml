# This workflow checks the AblyPlugin library. This library is only available via SPM.

name: "Check AblyPlugin"

on:
  workflow_dispatch:
  pull_request:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: macos-15

    steps:
      - uses: actions/checkout@v4
        with:
          submodules: true
      - uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: 16.3

      # It's important that we catch any compiler warnings here, because this is
      # the only place we can do so â€” that is, the CI jobs for e.g. the
      # LiveObjects plugin, which consume AblyPlugin, won't catch compiler
      # warnings since SPM does not expose warnings generated by dependencies.
      #
      # https://forums.swift.org/t/warnings-as-errors-for-libraries-frameworks/58393/2
      - run: swift build -Xswiftc -warnings-as-errors
